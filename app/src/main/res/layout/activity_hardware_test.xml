<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="16dp"
    android:background="#f5f5f5">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">

        <!-- Header -->
        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ðŸ”§ PUDO Kiosk Hardware Test Center"
            android:textSize="22sp"
            android:textStyle="bold"
            android:textColor="#2E7D32"
            android:gravity="center"
            android:layout_marginBottom="16dp"
            android:background="#E8F5E8"
            android:padding="16dp" />

        <!-- Progress Bar -->
        <ProgressBar
            android:id="@+id/progressBar"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="16dp"
            android:visibility="gone" />

        <!-- ===== LOCKER CONTROLLER SECTION ===== -->
        <!-- Add this section to your existing activity_hardware_test.xml -->

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#ffffff"
            android:padding="16dp"
            android:layout_marginBottom="16dp"
            android:elevation="3dp">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ”’ STM32L412 Locker Controller"
                android:textStyle="bold"
                android:textSize="16sp"
                android:textColor="#1976D2"
                android:layout_marginBottom="12dp" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Winnsen protocol communication with 16-lock controller via RS485"
                android:textSize="12sp"
                android:textColor="#666666"
                android:layout_marginBottom="16dp" />

            <!-- Connection and Test Controls -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp">

                <Button
                    android:id="@+id/btnConnectLocker"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Connect"
                    android:background="#1976D2"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp"
                    android:textSize="11sp" />

                <Button
                    android:id="@+id/btnTestCommunication"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Test Comm"
                    android:background="#388E3C"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp"
                    android:textSize="11sp"
                    android:enabled="false" />
            </LinearLayout>

            <!-- Lock Selection -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp"
                android:gravity="center_vertical">

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Select Lock:"
                    android:textSize="12sp"
                    android:textColor="#333333"
                    android:layout_marginEnd="8dp" />

                <Spinner
                    android:id="@+id/spinnerLockNumber"
                    android:layout_width="120dp"
                    android:layout_height="wrap_content"
                    android:layout_marginEnd="8dp" />

                <TextView
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="(Locks 1-16)"
                    android:textSize="10sp"
                    android:textColor="#666666" />
            </LinearLayout>

            <!-- Single Lock Operations -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp">

                <Button
                    android:id="@+id/btnUnlockSingle"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Unlock Selected"
                    android:background="#FF9800"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp"
                    android:textSize="10sp"
                    android:enabled="false" />

                <Button
                    android:id="@+id/btnCheckStatus"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Check Status"
                    android:background="#607D8B"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp"
                    android:textSize="10sp"
                    android:enabled="false" />
            </LinearLayout>

            <!-- Batch Operations -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp">

                <Button
                    android:id="@+id/btnCheckAllStatus"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Check All Status"
                    android:background="#5E35B1"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp"
                    android:textSize="10sp"
                    android:enabled="false" />

                <Button
                    android:id="@+id/btnEmergencyUnlock"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="âš ï¸ Emergency"
                    android:background="#D32F2F"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp"
                    android:textSize="10sp"
                    android:enabled="false" />
            </LinearLayout>

            <!-- Locker Status Display -->
            <TextView
                android:id="@+id/tvLockerStatus"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Ready for locker controller testing"
                android:textSize="12sp"
                android:padding="12dp"
                android:background="#E8F5E8"
                android:layout_marginBottom="8dp"
                android:textColor="#2E7D32" />

            <!-- Locker Communication Log Display -->
            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ“‹ Locker Communication Log"
                android:textStyle="bold"
                android:textSize="13sp"
                android:textColor="#333333"
                android:layout_marginBottom="4dp" />

            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="4dp">

                <Button
                    android:id="@+id/btnClearLockerLog"
                    android:layout_width="wrap_content"
                    android:layout_height="30dp"
                    android:text="Clear Log"
                    android:background="#795548"
                    android:textColor="#FFFFFF"
                    android:textSize="10sp"
                    android:minWidth="80dp" />

                <TextView
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Protocol frames and responses"
                    android:textSize="10sp"
                    android:textColor="#666666"
                    android:gravity="end|center_vertical" />
            </LinearLayout>

            <ScrollView
                android:id="@+id/scrollLockerLog"
                android:layout_width="match_parent"
                android:layout_height="120dp"
                android:background="#F8F8F8"
                android:padding="2dp">

                <TextView
                    android:id="@+id/tvLockerLog"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:text="Locker communication log will appear here"
                    android:textSize="10sp"
                    android:fontFamily="monospace"
                    android:padding="8dp"
                    android:textColor="#333333" />
            </ScrollView>
        </LinearLayout>

        <!-- ===== LOCKER CONTROLLER SECTION ===== -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#ffffff"
            android:padding="16dp"
            android:layout_marginBottom="16dp"
            android:elevation="2dp">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ”Œ RS485 Communication Test (STM32L412)"
                android:textStyle="bold"
                android:textSize="18sp"
                android:textColor="#1976D2"
                android:layout_marginBottom="12dp" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Low-level RS485 communication testing for STM32L412 boards at 9600 baud"
                android:textSize="12sp"
                android:textColor="#666666"
                android:layout_marginBottom="16dp" />

            <!-- Listening and Log Controls -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp">

                <Button
                    android:id="@+id/btnStartListening"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Start Listening"
                    android:background="#607D8B"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp"
                    android:textSize="11sp"
                    android:enabled="true" />

                <Button
                    android:id="@+id/btnClearCommLog"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Clear Log"
                    android:background="#795548"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp"
                    android:textSize="11sp" />
            </LinearLayout>

            <!-- Serial Connection Status -->
            <TextView
                android:id="@+id/tvSerialStatus"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Ready for RS485 communication testing"
                android:textSize="12sp"
                android:padding="12dp"
                android:background="#E8F5E8"
                android:layout_marginBottom="8dp"
                android:textColor="#2E7D32" />

            <!-- Communication Log Display -->
            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ“‹ Communication Log"
                android:textStyle="bold"
                android:textSize="13sp"
                android:textColor="#333333"
                android:layout_marginBottom="4dp" />

            <ScrollView
                android:id="@+id/scrollCommLog"
                android:layout_width="match_parent"
                android:layout_height="150dp"
                android:background="#F8F8F8"
                android:padding="2dp">

                <TextView
                    android:id="@+id/tvCommLog"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:text="Click 'Scan Serial' to discover connected devices"
                    android:textSize="10sp"
                    android:fontFamily="monospace"
                    android:padding="8dp"
                    android:textColor="#333333" />
            </ScrollView>
        </LinearLayout>

        <!-- ===== BARCODE SCANNER SECTION ===== -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#ffffff"
            android:padding="16dp"
            android:layout_marginBottom="16dp"
            android:elevation="3dp">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ“± Honeywell Xenon 1900 Barcode Scanner"
                android:textStyle="bold"
                android:textSize="18sp"
                android:textColor="#1976D2"
                android:layout_marginBottom="8dp" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="15-pin SUB-D to RS232 connection @ 115200 baud"
                android:textSize="12sp"
                android:textColor="#666666"
                android:layout_marginBottom="12dp" />

            <!-- Scanner Status -->
            <TextView
                android:id="@+id/tvScannerStatus"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Scanner status: Initializing..."
                android:textSize="12sp"
                android:background="#FFF8E1"
                android:padding="8dp"
                android:layout_marginBottom="8dp" />

            <!-- Scanner Control Buttons -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp">

                <Button
                    android:id="@+id/btnScannerFocus"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Focus Input"
                    android:background="#FF9800"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp" />

                <Button
                    android:id="@+id/btnTriggerScan"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="ðŸ“¸ Trigger Scan"
                    android:background="#4CAF50"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp"
                    android:enabled="false" />
            </LinearLayout>

            <!-- Scanner Utility Buttons -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="12dp">

                <Button
                    android:id="@+id/btnClearScans"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Clear Results"
                    android:background="#9E9E9E"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp" />

                <Button
                    android:id="@+id/btnScannerReconnect"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Reconnect"
                    android:background="#2196F3"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp" />
            </LinearLayout>

            <!-- Scanner Instructions -->
            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ“‹ Instructions: Press 'Trigger Scan' then point scanner at barcode and pull physical trigger. Results appear below with timestamps."
                android:textSize="11sp"
                android:textColor="#757575"
                android:background="#F5F5F5"
                android:padding="8dp"
                android:layout_marginBottom="8dp" />

            <!-- Scanned Results Display -->
            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ“¸ Scanned Results:"
                android:textStyle="bold"
                android:textSize="14sp"
                android:layout_marginBottom="4dp" />

            <EditText
                android:id="@+id/etScannerResults"
                android:layout_width="match_parent"
                android:layout_height="120dp"
                android:gravity="top"
                android:hint="Scanned barcodes will appear here with timestamps...\n\nClick 'Trigger Scan' to activate scanner.\nPoint scanner at barcode and pull physical trigger."
                android:inputType="textMultiLine"
                android:background="#F8F8F8"
                android:padding="12dp"
                android:textSize="11sp"
                android:scrollbars="vertical"
                android:fontFamily="monospace"
                android:layout_marginBottom="8dp" />

            <!-- Scanner Connection Info -->
            <TextView
                android:id="@+id/tvScannerInfo"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Connection info will appear here when connected"
                android:textSize="10sp"
                android:textColor="#9E9E9E"
                android:visibility="gone" />

        </LinearLayout>

        <!-- ===== THERMAL PRINTER SECTION ===== -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#ffffff"
            android:padding="16dp"
            android:layout_marginBottom="16dp"
            android:elevation="3dp">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ–¨ï¸ Custom TG2480HIII Thermal Printer"
                android:textStyle="bold"
                android:textSize="18sp"
                android:textColor="#1976D2"
                android:layout_marginBottom="8dp" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="USB connection using Custom SpA Android API"
                android:textSize="12sp"
                android:textColor="#666666"
                android:layout_marginBottom="12dp" />

            <!-- Printer Status -->
            <TextView
                android:id="@+id/tvPrinterStatus"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Printer status: Initializing..."
                android:textSize="12sp"
                android:background="#E3F2FD"
                android:padding="8dp"
                android:layout_marginBottom="8dp" />

            <!-- Printer Details -->
            <TextView
                android:id="@+id/tvPrinterDetails"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Ready: ? | Paper: ? | Connection: ?"
                android:textSize="11sp"
                android:padding="6dp"
                android:background="#FAFAFA"
                android:layout_marginBottom="12dp" />

            <!-- Basic Print Test Buttons -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="8dp">

                <Button
                    android:id="@+id/btnPrintTest"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Print Test Page"
                    android:background="#4CAF50"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp" />

                <Button
                    android:id="@+id/btnPrinterStatus"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Check Status"
                    android:background="#2196F3"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp" />
            </LinearLayout>

            <!-- Advanced Print Test Buttons -->
            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content">

                <Button
                    android:id="@+id/btnPrintReceipt"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Print Receipt"
                    android:background="#FF9800"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="4dp" />

                <Button
                    android:id="@+id/btnPrintBarcode"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="Print Barcodes"
                    android:background="#9C27B0"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="4dp" />
            </LinearLayout>

        </LinearLayout>

        <!-- ===== COMPREHENSIVE TESTING SECTION ===== -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#ffffff"
            android:padding="16dp"
            android:layout_marginBottom="16dp"
            android:elevation="3dp">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="ðŸ” Comprehensive Testing"
                android:textStyle="bold"
                android:textSize="18sp"
                android:textColor="#1976D2"
                android:layout_marginBottom="12dp" />

            <LinearLayout
                android:orientation="horizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content">

                <Button
                    android:id="@+id/btnRunAllTests"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="ðŸ§ª Run All Tests"
                    android:background="#4CAF50"
                    android:textColor="#FFFFFF"
                    android:layout_marginEnd="8dp"
                    android:textSize="16sp"
                    android:padding="12dp" />

                <Button
                    android:id="@+id/btnResetAll"
                    android:layout_weight="1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:text="ðŸ”„ Reset All"
                    android:background="#FF5722"
                    android:textColor="#FFFFFF"
                    android:layout_marginStart="8dp"
                    android:textSize="16sp"
                    android:padding="12dp" />
            </LinearLayout>

        </LinearLayout>

        <!-- ===== SYSTEM INFO SECTION ===== -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="#ffffff"
            android:padding="16dp"
            android:layout_marginBottom="16dp"
            android:elevation="3dp">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="â„¹ï¸ System Information"
                android:textStyle="bold"
                android:textSize="18sp"
                android:textColor="#1976D2"
                android:layout_marginBottom="8dp" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Hardware Platform: Rockchip RK3399-all Android Box\nAndroid Version: 7.1.2 (API Level 25)\nScreen: 10.1&quot; Portrait Orientation\n\nHardware Components:\nâ€¢ STM32L412 Locker Controllers (RS485)\nâ€¢ Honeywell Xenon 1900 Scanner (RS232)\nâ€¢ Custom TG2480HIII Thermal Printer (USB)\n\nSoftware Stack:\nâ€¢ Kotlin for Android 7.1.2\nâ€¢ TypeScript compatible interfaces\nâ€¢ Custom manufacturer APIs\nâ€¢ Serial communication libraries"
                android:textSize="11sp"
                android:padding="12dp"
                android:background="#F8F8F8"
                android:fontFamily="monospace" />

        </LinearLayout>

        <!-- Footer spacer -->
        <View
            android:layout_width="match_parent"
            android:layout_height="32dp" />

    </LinearLayout>
</ScrollView>